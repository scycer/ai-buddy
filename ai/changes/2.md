# Notes App Project Plan with Convex-Specific Recommendations

## Schema Design
- Use Convex's `defineCollection` with zod schema validation for the notes table
- Notes schema should include content, timestamps, delete flag, and user ID
- Consider adding indexes for frequently queried fields (userId, dateUpdated) for better performance

## Convex Backend Functions

### Query Functions
1. **List Notes Query**
   - Use Convex's `.filter()` to exclude deleted notes
   - Implement proper pagination with `.order("dateUpdated", "desc")` for newest-first sorting
   - Add user-specific filtering with `.filter(q => q.eq("userId", userId))`
   - Use proper TypeScript return types for better type safety

2. **Get Note by ID Query**
   - Implement validation to check if note exists
   - Return null for deleted notes
   - Add authorization to ensure users can only access their own notes

### Mutation Functions
1. **Add Note Mutation**
   - Use `ctx.db.insert()` for database operations
   - Set proper timestamps with `new Date()`
   - Return the new document ID for client-side navigation
   - Add validation for required fields

2. **Update Note Mutation**
   - Use `ctx.db.patch()` for updating existing notes
   - Include validation to prevent updating deleted notes
   - Update only the `dateUpdated` and content fields
   - Return success/failure status

3. **Delete Note Mutation (Soft Delete)**
   - Implement as a patch operation that sets `isDeleted: true`
   - Update the `dateUpdated` field
   - Add validation to ensure the note exists before deleting
   - Use proper error handling with descriptive messages

## React Frontend Components

### Notes List Component
- Use Convex's `useQuery` hook to reactively fetch notes
- Display notes with edit/delete buttons for each note
- Show last updated timestamp 
- Include pagination or infinite scrolling for better performance
- Add sorting options (newest/oldest first)

### Note Form Component
- Create a reusable component for both creating and editing notes
- Use React state to manage form inputs
- Implement form validation for required fields
- Use Convex's `useMutation` hook to save changes
- Add loading states during mutations

### Navigation and Layout
- Implement a consistent layout with navigation
- Use React Router for routing between pages
- Create routes for home, notes list, and note editor
- Add proper error boundaries for handling errors

## Authentication & Authorization
- Implement Convex authentication (consider OAuth providers)
- Add user management if needed
- Ensure proper data isolation between users
- Add authorization checks in queries and mutations

## Best Practices
- Set up proper TypeScript types for all functions
- Use Convex's generated types for type safety
- Implement error handling in both frontend and backend
- Consider implementing optimistic updates for better UX
- Use React's suspense for loading states

## Deployment
- Configure Convex deployment for production
- Deploy frontend to Vercel/Netlify
- Set up proper environment variables
- Implement monitoring and error reporting

## Future Enhancements
- Rich text editing with a library like Quill or TipTap
- Note categories/tags
- Collaborative editing
- Search functionality (leverage Convex's search capabilities)
- File attachments (using Convex file storage)
